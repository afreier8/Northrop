function loadBannerImpressions(){var analysis={event:"bannerChange",ecommerce:{promoView:{promotions:[]}}};$("section.jumbotron div.ui-hero div.slick-list div.slick-slide").not(".slick-cloned").each(function(index){var data_name=$(this).attr("data-name"),data_id=$(this).attr("data-id"),data_creative=$(this).attr("data-creative"),data_position=$(this).attr("data-position");analysis.ecommerce.promoView.promotions.push({name:data_name,id:data_id,creative:data_creative,position:data_position})}),dataLayer.push(analysis)}function loadStaticBannerImpressions(){var itemList=[];$("section.ui-bspots div.ui-bspots-container section.ui-bspots__item div.ui-bspots__item--content a").each(function(index){itemList.push(this)});$("div.cspot div.feature div.feature-content a.btn").each(function(index){itemList.push(this)}),$("div.cspot section div.col-md-4 div.col-sm-6 a").each(function(){null!=$(this).attr("data-name")&&itemList.push(this)});if(0!=itemList.length){var analysis={event:"staticBanner",ecommerce:{promoView:{promotions:[]}}};$(itemList).each(function(index){var data_name=$(this).attr("data-name"),data_id=$(this).attr("data-id"),data_creative=$(this).attr("data-creative"),data_position=index+1;analysis.ecommerce.promoView.promotions.push({name:data_name,id:data_id,creative:data_creative,position:data_position})}),dataLayer.push(analysis)}}function onProductClick(obj){var list=$(obj).attr("data-list"),skuId=$(obj).attr("data-skuId"),isInStock=$(obj).attr("data-stockStatus"),searchType=$(obj).attr("data-searchType"),url=$(obj).attr("href");searchType?dataLayer.push({event:"productClick",ecommerce:{click:{actionField:{list:list},products:[{id:skuId,dimension16:isInStock,dimension20:searchType}]}},eventCallback:function(){document.location=url}}):dataLayer.push({event:"productClick",ecommerce:{click:{actionField:{list:list},products:[{id:skuId,dimension16:isInStock}]}},eventCallback:function(){document.location=url}})}function onEGCAddToCart(obj){if(null!=obj){var skuId=$(obj).attr("data-skuId"),amount=$(obj).parents("#formEGC").find("#egc_amount").val();dataLayer.push({event:"addToCart",ecommerce:{add:{products:[{id:skuId,price:amount}]}}})}}function onOrderGlassesClick(obj1,obj2){if(null!=obj1){var source=$(obj1).attr("data-source"),skuId=$(obj2).attr("id");dataLayer.push({event:"trackEvent",eventCategory:"Order Glasses "+source,eventAction:"Click",eventLabel:skuId})}}function pushPLPDataLayer(obj){if(null!=obj){var dest=$(obj).parent().find(".colorBox .colorCon a.recently");null!=dest&&onOrderGlassesClick(obj,dest)}}function pushPDPDataLayer(obj){if(null!=obj){var dest=$(obj).parent().parent().find(".colorBox .colorCon a.recently");null!=dest&&onOrderGlassesClick(obj,dest)}}function onCheckoutClick(step1,step2,shouldShowPM){$.ajax({dataType:"json",async:!1,data:{step1:step1,step2:step2,shouldShowPM:shouldShowPM},url:"/common/analysis/order_analysis_ssl.jsp",success:function(data){data.result1&&dataLayer.push(data.result1),data.result2&&dataLayer.push(data.result2)},error:function(){console.log("can not get json array!")}})}function onPromoClick(obj){if(null!=obj){var name=$(obj).attr("data-name"),id=$(obj).attr("data-id"),creative=$(obj).attr("data-creative"),position=$(obj).attr("data-position"),destinationUrl=$(obj).attr("href");dataLayer.push({event:"promotionClick",ecommerce:{promoClick:{promotions:[{id:id,name:name,creative:creative,position:position}]}},eventCallback:function(){document.location=destinationUrl}})}}function onASpotPromoClick(obj){if(null!=obj){var slideItem=$(obj).parents().find("div.slide").filter(".slick-active");if(slideItem){var name=$(slideItem).attr("data-name"),id=$(slideItem).attr("data-id"),creative=$(slideItem).attr("data-creative"),position=$(slideItem).attr("data-position"),destinationUrl=$(obj).attr("href");dataLayer.push({event:"promotionClick",ecommerce:{promoClick:{promotions:[{id:id,name:name,creative:creative,position:position}]}},eventCallback:function(){document.location=destinationUrl}})}}}function onVSPromoClick(obj){if(null!=obj){var name=$(obj).attr("data-name"),id=$(obj).attr("data-id"),creative=$(obj).attr("data-creative"),position=$(obj).attr("data-position");$(obj).attr("href");dataLayer.push({event:"promotionClick",ecommerce:{promoClick:{promotions:[{id:id,name:name,creative:creative,position:position}]}}})}}function onCLPProductItemClick(obj){if(null!=obj){var item=$(obj).parent().parent().find("figure.product-media a.product-media__link");null!=item&&onProductClick(item)}}function onCLPFeatureItemClick(obj){if(null!=obj){var item=$(obj).parent().parent().find("div.feature-media a.feature-media__link");null!=item&&onProductClick(item)}}function onVSDetailClick(obj){if(null!=obj){var item=$(obj).parents().find(".product-item figure a");null!=item&&onProductClick(item)}}function chatonLine(){window.open("https://livechat.zennioptical.com/chat.php?acid=379d5","","width=590,height=760,left=0,top=0,resizable=yes,menubar=no,location=no,status=yes,scrollbars=yes")}function myGetElementsByClassName(selector){if(document.getElementsByClassName)return document.getElementsByClassName(selector);for(var returnList=new Array,nodes=document.getElementsByTagName("div"),max=nodes.length,i=0;i<max;i++)nodes[i].className==selector&&(returnList[returnList.length]=nodes[i]);return returnList}if($.fn.extend({focusblur:function(focusFn,blurFn){var target=$(this);target.focus(focusFn),target.blur(blurFn)},placeholder:function(text){this.focusblur(function(){0==$(this).val().length&&($(this).attr("placeholder",""),$(this).val(""),$(this).removeClass("tInput_ph"))},function(){0==$(this).val().length?($(this).attr("placeholder",text),$(this).addClass("tInput_ph")):($(this).attr("placeholder",""),$(this).removeClass("tInput_ph"))})},selectPlaceholder:function(text){this.click(function(){var labelObj=$(this),labelCts=$(this).children("label").text();labelCts.indexOf(text)>=0?labelObj.addClass("tInput_ph"):labelObj.removeClass("tInput_ph")})}}),$(document).ready(function(){loadBannerImpressions(),loadStaticBannerImpressions()}),location.href.indexOf("#/")>-1){var hrefSlit=location.href.split("#");hrefSlit.splice(0,1);var domainUrl=window.location.href,domain=domainUrl.split("/");location.assign(domain[0]+"//"+domain[2]+hrefSlit.join("#"))}var Footer={emailSignUp:function(promotionCode){var emailId=$("#emailId").val();if("Email Address"!=emailId){var form=$("#mailSignUp");form.ajaxSubmit({type:"post",url:ctx+"/cartridges/emailSignUp/emailSignUp.jsp",dataType:"json",success:function(data){var response=data,signUpMessageId=$("#signUpMessageId");signUpMessageId.removeClass(),1==response.success?signUpMessageId.addClass("successMsg"):signUpMessageId.addClass("error"),signUpMessageId.text(data.message),signUpMessageId.show()},error:function(data){alert("Thank you for subscribing!")}})}}};$(function(){$(".emailSignUp .textInput").keydown(function(e){var curKey=e.which;if(13==curKey)return Footer.emailSignUp(),!1})});var rssReader={containers:null,init:function(selector){for(containers=myGetElementsByClassName(selector),i=0;i<containers.length;i++){var rssUrl=containers[i].getAttribute("rss_url"),num=containers[i].getAttribute("rss_num"),id=containers[i].getAttribute("id"),url=encodeURIComponent(rssUrl),googUrl="https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&num="+num+"&q="+url+"&callback=rssReader.parse&context="+id,script=document.createElement("script");script.setAttribute("type","text/javascript"),script.setAttribute("charset","utf-8"),script.setAttribute("src",googUrl),containers[i].appendChild(script)}},parse:function(context,data){var container=document.getElementById(context);container.innerHTML="";var mainList=document.createElement("ul");mainList.setAttribute("class","vList");for(var entries=data.feed.entries,i=0;i<entries.length;i++){var listItem=document.createElement("li"),span=document.createElement("span"),plusSign=document.createTextNode("+");span.appendChild(plusSign),listItem.appendChild(span);var title=entries[i].title,contentSnippet=entries[i].contentSnippet,link=(document.createTextNode(contentSnippet),document.createElement("a"));link.setAttribute("href",entries[i].link),link.setAttribute("target","_blank");var text=document.createTextNode(title);link.appendChild(text),listItem.appendChild(link),mainList.appendChild(listItem)}container.appendChild(mainList)}};window.onload=function(){rssReader.init("post_results")};